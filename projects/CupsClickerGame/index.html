<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Wasteland Clicker: Pip-Boy Edition v1.1</title>
    <style>
        /* --- –®—Ä–∏—Ñ—Ç—ã –∏ –ë–∞–∑–æ–≤—ã–π —Å—Ç–∏–ª—å --- */
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');

        :root {
            --pip-green: #33ff00;
            --pip-dim: #1a8000;
            --pip-bg: #050505;
            --pip-scanline: rgba(18, 16, 16, 0);
        }

        body {
            background-color: var(--pip-bg);
            color: var(--pip-green);
            font-family: 'VT323', monospace;
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
        }

        /* --- CRT –≠—Ñ—Ñ–µ–∫—Ç (–°–∫–∞–Ω–ª–∞–π–Ω) --- */
        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(
                to bottom,
                rgba(255,255,255,0),
                rgba(255,255,255,0) 50%,
                rgba(0,0,0,0.2) 50%,
                rgba(0,0,0,0.2)
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 1000;
            box-shadow: inset 0 0 5rem rgba(0,0,0,0.7);
        }

        .screen-glow {
            animation: textShadow 1.6s infinite;
        }

        @keyframes textShadow {
            0% { text-shadow: 0.4px 0 1px rgba(0,30,255,0.5), -0.4px 0 1px rgba(255,0,80,0.3), 0 0 3px; }
            50% { text-shadow: 2.6px 0 1px rgba(0,30,255,0.5), -2.6px 0 1px rgba(255,0,80,0.3), 0 0 3px; }
            100% { text-shadow: 0.4px 0 1px rgba(0,30,255,0.5), -0.4px 0 1px rgba(255,0,80,0.3), 0 0 3px; }
        }

        /* --- Layout --- */
        #game-container {
            display: flex;
            height: 100%;
            width: 100%;
        }

        .section-left {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-right: 2px solid var(--pip-dim);
            padding: 20px;
            position: relative;
        }

        .section-mid {
            flex: 1;
            border-right: 2px solid var(--pip-dim);
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            padding: 10px;
        }

        .section-right {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            background: rgba(0, 20, 0, 0.3);
            /* –ß—Ç–æ–±—ã –ø–æ–¥—Å–∫–∞–∑–∫–∏ –Ω–µ –æ–±—Ä–µ–∑–∞–ª–∏—Å—å, –µ—Å–ª–∏ –≤—ã—Ö–æ–¥—è—Ç –∑–∞ –∫—Ä–∞–π, –Ω—É–∂–µ–Ω visible, 
               –Ω–æ —Ç–æ–≥–¥–∞ —Å–∫—Ä–æ–ª–ª —Å–ª–æ–º–∞–µ—Ç—Å—è. –ò—Å–ø–æ–ª—å–∑—É–µ–º position fixed/absolute –≤–Ω—É—Ç—Ä–∏ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é. */
        }

        /* --- –≠–ª–µ–º–µ–Ω—Ç—ã UI --- */
        h1, h2, h3 { margin: 5px 0; text-transform: uppercase; letter-spacing: 2px; }
        
        .caps-display {
            font-size: 3rem;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .cps-display {
            font-size: 1.2rem;
            opacity: 0.8;
            margin-bottom: 30px;
        }

        /* –ö–Ω–æ–ø–∫–∞-–ö—Ä—ã—à–∫–∞ */
        #big-cap {
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, #a00000 30%, #500000 90%);
            border: 5px solid #d4d4d4;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
            cursor: pointer;
            box-shadow: 0 0 20px var(--pip-green);
            transition: transform 0.1s;
            position: relative;
            text-shadow: 2px 2px 0px black;
            z-index: 10;
        }
        #big-cap:active { transform: scale(0.95); }
        #big-cap::before {
            content: "NUKA";
            font-family: sans-serif;
            font-weight: bold;
        }

        /* –ú–∞–≥–∞–∑–∏–Ω */
        .store-item {
            position: relative; /* –î–ª—è –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–¥—Å–∫–∞–∑–∫–∏ */
            border: 1px solid var(--pip-green);
            margin-bottom: 8px;
            padding: 10px;
            cursor: pointer;
            background: rgba(0,0,0,0.5);
            transition: background 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .store-item:hover { background: var(--pip-dim); color: black; }
        .store-item.disabled { opacity: 0.5; cursor: not-allowed; filter: grayscale(1); }
        .item-info { display: flex; flex-direction: column; }
        .item-name { font-weight: bold; font-size: 1.2rem; }
        .item-cost { font-size: 0.9rem; }
        .item-count { font-size: 2rem; font-weight: bold; }

        /* –ü–û–î–°–ö–ê–ó–ö–ò (TOOLTIPS) */
        .tooltip-box {
            visibility: hidden;
            width: 180px;
            background-color: #001a00;
            color: var(--pip-green);
            text-align: left;
            border: 1px solid var(--pip-green);
            padding: 8px;
            position: absolute;
            z-index: 100;
            right: 105%; /* –°–ª–µ–≤–∞ –æ—Ç —ç–ª–µ–º–µ–Ω—Ç–∞ */
            top: 50%;
            transform: translateY(-50%);
            opacity: 0;
            transition: opacity 0.2s;
            box-shadow: 4px 4px 0px rgba(0,0,0,0.8);
            pointer-events: none;
            font-size: 1rem;
            line-height: 1.2;
        }
        
        .tooltip-box::after {
            content: " ";
            position: absolute;
            top: 50%;
            left: 100%; /* –°—Ç—Ä–µ–ª–∫–∞ —Å–ø—Ä–∞–≤–∞ */
            margin-top: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: transparent transparent transparent var(--pip-green);
        }

        .store-item:hover .tooltip-box {
            visibility: visible;
            opacity: 1;
        }

        .tooltip-desc { font-size: 0.85rem; color: #7acc7a; margin-bottom: 5px; display: block; font-style: italic;}
        .tooltip-stat { font-weight: bold; border-top: 1px dashed #1a8000; padding-top: 3px; display: block;}


        /* –ê–ø–≥—Ä–µ–π–¥—ã */
        #upgrades-container {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 20px;
            min-height: 50px;
            border-bottom: 1px dashed var(--pip-green);
            padding-bottom: 10px;
        }
        .upgrade-icon {
            width: 50px;
            height: 50px;
            border: 1px solid var(--pip-green);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 24px;
        }
        .upgrade-icon:hover { background: var(--pip-green); color: black; }
        
        /* –ë–µ–≥—É—â–∞—è —Å—Ç—Ä–æ–∫–∞ */
        #news-ticker {
            border-top: 2px solid var(--pip-green);
            padding: 5px;
            white-space: nowrap;
            overflow: hidden;
            font-size: 1.1rem;
            background: #001100;
            width: 100%;
            box-sizing: border-box;
        }

        /* –í—Å–ø–ª—ã–≤–∞—é—â–∏–µ —á–∞—Å—Ç–∏—Ü—ã */
        .floating-text {
            position: absolute;
            color: white;
            font-weight: bold;
            pointer-events: none;
            animation: floatUp 1s ease-out forwards;
            text-shadow: 1px 1px 0 #000;
            z-index: 999;
        }
        @keyframes floatUp {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-50px); opacity: 0; }
        }

        /* –ö–Ω–æ–ø–∫–∏ –º–µ–Ω—é */
        .menu-btn {
            background: transparent;
            border: 1px solid var(--pip-green);
            color: var(--pip-green);
            padding: 5px 10px;
            margin-top: 10px;
            cursor: pointer;
            font-family: inherit;
        }
        .menu-btn:hover { background: var(--pip-green); color: black; }

        /* –ê–¥–∞–ø—Ç–∏–≤ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
        @media (max-width: 800px) {
            body { overflow: auto; }
            #game-container { flex-direction: column; }
            .section-left, .section-mid, .section-right {
                flex: none;
                width: 100%;
                border-right: none;
                border-bottom: 2px solid var(--pip-dim);
                box-sizing: border-box;
            }
            .section-left { padding-top: 40px; }
            #big-cap { width: 150px; height: 150px; }
            
            /* –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —Ç—É–ª—Ç–∏–ø—ã –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–Ω–∏–∑—É/—Å–≤–µ—Ä—Ö—É, –∞ –Ω–µ —Å–±–æ–∫—É */
            .tooltip-box {
                right: auto;
                left: 10px;
                top: -100%; /* –°–≤–µ—Ä—Ö—É —ç–ª–µ–º–µ–Ω—Ç–∞ */
                width: 250px;
                transform: none;
                background-color: #000;
                z-index: 999;
            }
            .tooltip-box::after { display: none; }
        }
    </style>
</head>
<body>

<div class="scanlines"></div>

<div id="game-container" class="screen-glow">
    <!-- –õ–ï–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –û—Å–Ω–æ–≤–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ -->
    <div class="section-left">
        <div id="news-ticker">/// ROBCO INDUSTRIES TERMINAL LINK ONLINE ///</div>
        <div class="caps-display"><span id="caps">0.00</span> CAPS</div>
        <div class="cps-display">per second: <span id="cps">0.00</span></div>
        
        <div id="big-cap"></div>
        
        <div style="margin-top: 20px; text-align: center;">
            <button class="menu-btn" onclick="saveGame()">SAVE DATA</button>
            <button class="menu-btn" onclick="resetGame()">PURGE DATA</button>
        </div>
    </div>

    <!-- –°–†–ï–î–ù–Ø–Ø –ö–û–õ–û–ù–ö–ê: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –ê–ø–≥—Ä–µ–π–¥—ã -->
    <div class="section-mid">
        <h2>:: UPGRADES ::</h2>
        <div id="upgrades-container">
            <div style="opacity: 0.5; font-size: 0.8rem;">[AWAITING DATA...]</div>
        </div>

        <h2>:: HOLOTAPE LOG ::</h2>
        <div id="stats-log">
            <p>> Status: <span style="color:var(--pip-green)">HEALTHY</span></p>
            <p>> Time Wasted: <span id="time-played">0</span> sec</p>
            <p>> Manual Clicks: <span id="total-clicks">0</span></p>
        </div>
    </div>

    <!-- –ü–†–ê–í–ê–Ø –ö–û–õ–û–ù–ö–ê: –ú–∞–≥–∞–∑–∏–Ω -->
    <div class="section-right">
        <h2 style="text-align: center; border-bottom: 1px solid var(--pip-green); padding-bottom:5px;">:: SUPPLY STORE ::</h2>
        <div id="store-container">
            <!-- –ó–¥–∞–Ω–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è JS -->
        </div>
    </div>
</div>

<script>
/* --- –î–ê–ù–ù–´–ï –ò–ì–†–´ --- */

const buildingsData = [
    { id: 'cursor', name: 'Auto-Clicker', desc: 'A simple robotic finger.', cost: 15, baseCps: 0.1, icon: 'üëÜ' },
    { id: 'radroach', name: 'Tamed Radroach', desc: 'Disgusting, but loyal.', cost: 100, baseCps: 1, icon: 'ü™≥' },
    { id: 'scavenger', name: 'Scavenger', desc: 'Finds caps in the trash.', cost: 1100, baseCps: 8, icon: 'üéí' },
    { id: 'brahmin', name: 'Brahmin Caravan', desc: 'Two heads earn more caps.', cost: 12000, baseCps: 47, icon: 'üêÑ' },
    { id: 'turret', name: 'Laser Turret', desc: 'Aggressive negotiations.', cost: 130000, baseCps: 260, icon: 'üî´' },
    { id: 'vault', name: 'Vault 13', desc: 'A whole community working for you.', cost: 1400000, baseCps: 1400, icon: '‚öôÔ∏è' },
    { id: 'bos', name: 'B.O.S. Outpost', desc: 'Technology equals profit.', cost: 20000000, baseCps: 7800, icon: 'üõ°Ô∏è' }
];

const upgradesData = [
    { id: 'u_cursor_1', name: 'Reinforced Mouse', desc: 'Auto-Clickers are twice as efficient.', cost: 500, trigger: (g) => g.buildings['cursor'] >= 10, effect: (g) => multBuild(g, 'cursor', 2), icon: 'üñ±Ô∏è' },
    { id: 'u_roach_1', name: 'Radioactive Food', desc: 'Radroaches yield 2x Caps.', cost: 1000, trigger: (g) => g.buildings['radroach'] >= 10, effect: (g) => multBuild(g, 'radroach', 2), icon: '‚ò¢Ô∏è' },
    { id: 'u_scav_1', name: 'Metal Detector', desc: 'Scavengers are twice as efficient.', cost: 11000, trigger: (g) => g.buildings['scavenger'] >= 10, effect: (g) => multBuild(g, 'scavenger', 2), icon: 'üî¶' },
    { id: 'u_global_1', name: 'Nuka-Cola Quantum', desc: 'All production +10%', cost: 50000, trigger: (g) => g.capsTotal >= 10000, effect: (g) => g.globalMult *= 1.1, icon: 'ü•§' }
];

const newsTicker = [
    "War... War never changes.",
    "Radroach infestation reported in Sector 7.",
    "Someone stole your sweetroll.",
    "Brotherhood of Steel demands your technology.",
    "GARY? GARY!",
    "Super Mutants spotted near the water chip.",
    "Mysterious Stranger appeared and vanished.",
    "Stimpack prices up by 15%."
];

/* --- –õ–û–ì–ò–ö–ê –ò–ì–†–´ --- */

let game = {
    caps: 0.0,
    capsTotal: 0.0,
    clicks: 0,
    startTime: Date.now(),
    buildings: {},
    upgrades: [],
    globalMult: 1,
    buildingMults: {}
};

function init() {
    buildingsData.forEach(b => {
        game.buildings[b.id] = 0;
        game.buildingMults[b.id] = 1;
    });

    loadGame();
    renderStore();
    requestAnimationFrame(gameLoop);
    setInterval(saveGame, 30000);
    setInterval(updateTicker, 10000);
    updateTicker();
}

let lastTime = Date.now();

function gameLoop() {
    let now = Date.now();
    let dt = (now - lastTime) / 1000;
    lastTime = now;

    let cps = calculateCPS();
    if (cps > 0) {
        let earned = cps * dt;
        game.caps += earned;
        game.capsTotal += earned;
    }

    checkUpgrades();
    updateUI(cps);
    
    requestAnimationFrame(gameLoop);
}

function calculateCPS() {
    let cps = 0;
    buildingsData.forEach(b => {
        let count = game.buildings[b.id] || 0;
        let mult = game.buildingMults[b.id] || 1;
        cps += count * b.baseCps * mult;
    });
    return cps * game.globalMult;
}

// –ü–æ–ª—É—á–∏—Ç—å CPS –¥–ª—è –æ–¥–Ω–æ–≥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–¥–∞–Ω–∏—è (—Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö –±–æ–Ω—É—Å–æ–≤)
function getSingleBuildingCPS(id) {
    let b = buildingsData.find(x => x.id === id);
    let mult = game.buildingMults[id] || 1;
    return b.baseCps * mult * game.globalMult;
}

function multBuild(g, id, multiplier) {
    g.buildingMults[id] *= multiplier;
}

function checkUpgrades() {
    const container = document.getElementById('upgrades-container');
    if(container.children.length > 0 && container.children[0].innerText.includes("AWAITING")) {
        // –û–∂–∏–¥–∞–Ω–∏–µ
    }

    upgradesData.forEach(u => {
        if (!game.upgrades.includes(u.id) && u.trigger(game)) {
            if (!document.getElementById(`upg-${u.id}`)) {
                if(container.innerText.includes("AWAITING")) container.innerHTML = '';
                
                let el = document.createElement('div');
                el.id = `upg-${u.id}`;
                el.className = 'upgrade-icon';
                el.innerText = u.icon;
                el.title = `${u.name}\n${u.desc}\nCost: ${formatNumber(u.cost)}`;
                el.onclick = () => buyUpgrade(u);
                container.appendChild(el);
            }
        }
    });
}

function buyUpgrade(u) {
    if (game.caps >= u.cost) {
        game.caps -= u.cost;
        game.upgrades.push(u.id);
        u.effect(game);
        document.getElementById(`upg-${u.id}`).remove();
        updateUI(calculateCPS());
    }
}

document.getElementById('big-cap').addEventListener('click', (e) => {
    game.clicks++;
    let clickPower = 1 + (calculateCPS() * 0.05);
    if (clickPower < 1) clickPower = 1;
    
    game.caps += clickPower;
    game.capsTotal += clickPower;

    spawnFloatingText(e.clientX, e.clientY, `+${formatNumber(clickPower)}`);
});

function spawnFloatingText(x, y, text) {
    let el = document.createElement('div');
    el.className = 'floating-text';
    el.innerText = text;
    let offsetX = (Math.random() - 0.5) * 40;
    el.style.left = (x + offsetX) + 'px';
    el.style.top = (y - 20) + 'px';
    document.body.appendChild(el);
    setTimeout(() => el.remove(), 1000);
}

function renderStore() {
    const container = document.getElementById('store-container');
    container.innerHTML = '';

    buildingsData.forEach(b => {
        let el = document.createElement('div');
        el.className = 'store-item disabled';
        el.id = `store-${b.id}`;
        el.onclick = () => buyBuilding(b.id);
        
        // –î–æ–±–∞–≤–ª–µ–Ω .tooltip-box
        el.innerHTML = `
            <div class="tooltip-box">
                <span class="tooltip-desc">${b.desc}</span>
                <span class="tooltip-stat" id="tooltip-stat-${b.id}">Produces: ${formatNumber(getSingleBuildingCPS(b.id))} cps</span>
            </div>
            <div class="item-info">
                <span class="item-name">${b.icon} ${b.name}</span>
                <span class="item-cost" id="cost-${b.id}">Cost: ${formatNumber(getBuildingCost(b))}</span>
            </div>
            <span class="item-count" id="count-${b.id}">${game.buildings[b.id]}</span>
        `;
        container.appendChild(el);
    });
}

function getBuildingCost(b) {
    let count = game.buildings[b.id];
    return Math.floor(b.cost * Math.pow(1.15, count));
}

function buyBuilding(id) {
    let b = buildingsData.find(x => x.id === id);
    let cost = getBuildingCost(b);
    
    if (game.caps >= cost) {
        game.caps -= cost;
        game.buildings[id]++;
        
        document.getElementById(`count-${id}`).innerText = game.buildings[id];
        document.getElementById(`cost-${id}`).innerText = "Cost: " + formatNumber(getBuildingCost(b));
    }
}

function updateUI(cps) {
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π formatNumber –¥–ª—è float –∑–Ω–∞—á–µ–Ω–∏–π
    document.getElementById('caps').innerText = formatNumber(game.caps);
    document.getElementById('cps').innerText = formatNumber(cps);
    document.title = `${Math.floor(game.caps)} Caps - Wasteland Clicker`; // –í –∑–∞–≥–æ–ª–æ–≤–∫–µ –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å —Ü–µ–ª–æ–µ

    document.getElementById('time-played').innerText = Math.floor((Date.now() - game.startTime)/1000);
    document.getElementById('total-clicks').innerText = game.clicks;

    buildingsData.forEach(b => {
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–æ–∫ (–∞–∫—Ç–∏–≤–Ω–æ/–Ω–µ–∞–∫—Ç–∏–≤–Ω–æ)
        let btn = document.getElementById(`store-${b.id}`);
        let cost = getBuildingCost(b);
        if (game.caps >= cost) {
            btn.classList.remove('disabled');
        } else {
            btn.classList.add('disabled');
        }

        // –î–ò–ù–ê–ú–ò–ß–ï–°–ö–û–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï –¢–£–õ–¢–ò–ü–û–í
        // (–µ—Å–ª–∏ –∫—É–ø–∏–ª–∏ –∞–ø–≥—Ä–µ–π–¥ - —Ü–∏—Ñ—Ä–∞ –∏–∑–º–µ–Ω–∏—Ç—Å—è)
        let tooltipStat = document.getElementById(`tooltip-stat-${b.id}`);
        if(tooltipStat) {
            let currentYield = getSingleBuildingCPS(b.id);
            tooltipStat.innerText = `Produces: ${formatNumber(currentYield)} cps`;
        }
    });
}

function updateTicker() {
    const ticker = document.getElementById('news-ticker');
    const msg = newsTicker[Math.floor(Math.random() * newsTicker.length)];
    ticker.innerText = `/// NEWS: ${msg} ///`;
}

// –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è Float —Å 2 –∑–Ω–∞–∫–∞–º–∏
function formatNumber(num) {
    if (num < 1000) return num.toFixed(2); // –í—Å–µ–≥–¥–∞ 2 –∑–Ω–∞–∫–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä 10.50
    if (num < 1000000) return (num / 1000).toFixed(2) + 'k';
    if (num < 1000000000) return (num / 1000000).toFixed(2) + 'M';
    return (num / 1000000000).toFixed(2) + 'B';
}

function saveGame() {
    const saveString = JSON.stringify(game);
    localStorage.setItem('falloutClickerSave', saveString);
    spawnFloatingText(window.innerWidth/2, window.innerHeight/2, "DATA SAVED");
}

function loadGame() {
    const saveString = localStorage.getItem('falloutClickerSave');
    if (saveString) {
        const savedGame = JSON.parse(saveString);
        game = { ...game, ...savedGame };
        
        buildingsData.forEach(b => game.buildingMults[b.id] = 1);
        game.globalMult = 1;
        
        game.upgrades.forEach(upgId => {
            let uData = upgradesData.find(x => x.id === upgId);
            if (uData) uData.effect(game);
        });
    }
}

function resetGame() {
    if(confirm("Initiate protocol: ERASE? All progress will be lost.")) {
        localStorage.removeItem('falloutClickerSave');
        location.reload();
    }
}

init();

</script>
</body>
</html>
